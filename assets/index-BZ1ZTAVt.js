(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const h of i)if(h.type==="childList")for(const a of h.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function e(i){const h={};return i.integrity&&(h.integrity=i.integrity),i.referrerPolicy&&(h.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?h.credentials="include":i.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function o(i){if(i.ep)return;i.ep=!0;const h=e(i);fetch(i.href,h)}})();class Y{constructor(t,e,o,i,h,a=!1){this.currMap="Level 1",this.x=t,this.y=e,this.length=o,this.width=i,this.speed=h,this.velocityY=0,this.velX=0,this.gravity=.9,this.friction=.8,this.isJumping=!1,this.isDead=!1,this.onLeftWall=!1,this.onRightWall=!1,this.lastWallJump=null,this.worldHeight=1080,this.hardMode=a}draw(t){t.fillStyle="red",t.fillRect(this.x,this.y,this.length,this.width)}respawn(t){this.x=t.spawn.x,this.y=t.spawn.y,this.velX=0,this.velocityY=0,this.isDead=!1,this.isJumping=!1,this.lastWallJump=null}move(t){switch(t){case"a":this.velX=-this.speed;break;case"d":this.velX=this.speed;break;case" ":this.isJumping?this.onLeftWall&&this.lastWallJump!=="left"?(this.hardMode?this.velocityY=-15:this.velocityY=-20,this.isJumping=!0,this.gravity=.9,this.lastWallJump="left"):this.onRightWall&&this.lastWallJump!=="right"&&(this.hardMode?this.velocityY=-15:this.velocityY=-20,this.isJumping=!0,this.gravity=.9,this.lastWallJump="right"):(this.velocityY=-20,this.isJumping=!0);break}}update(t,e){let o=!1,i=!1;this.onLeftWall=!1,this.onRightWall=!1,this.x+=this.velX*t*60;for(const h of e)h.type==="wall"&&this.x+this.length>h.x&&this.x<h.x+h.width&&this.y+this.width>h.y&&this.y<h.y+h.height&&(this.velX>0?(this.x=h.x-this.length,this.onRightWall=!0):this.velX<0&&(this.x=h.x+h.width,this.onLeftWall=!0),this.velX=0);this.y+=this.velocityY*t*60,this.velocityY+=this.gravity*t*60;for(const h of e){const a=this.x+this.length>h.x&&this.x<h.x+h.width&&this.y+this.width>=h.y&&this.y+this.width<=h.y+h.height+this.velocityY*t*60,u=this.x+this.length>h.x&&this.x<h.x+h.width&&this.y>=h.y+h.height&&this.y+this.velocityY*t*60<=h.y+h.height;h.type==="floor"&&a?(this.y=h.y-this.width,this.velocityY=0,this.isJumping=!1,i=!0):h.type==="ice"&&a?(this.y=h.y-this.width,this.velocityY=0,this.isJumping=!1,o=!0):u&&(this.y=h.y+h.height,this.velocityY=0)}o?this.velX*=1:i&&(this.velX*=.8),Math.abs(this.velX)<.01&&(this.velX=0),this.y>=this.worldHeight&&(this.isDead=!0)}collides(t){return this.x<t.x+t.width&&this.x+this.length>t.x&&this.y<t.y+t.height&&this.y+this.width>t.y}}class g{constructor(t,e,o,i,h){this.x=t,this.y=e,this.width=o,this.height=i,this.nextLevel=h}draw(t){t.fillStyle="green",t.fillRect(this.x,this.y,this.width,this.height)}}const b=["red","blue","yellow","green","purple","pink","white"];class X{constructor(t,e,o,i,h=""){this.x=t,this.y=e,this.radius=o,this.sides=i,this.fillColor=h||b[Math.floor(Math.random()*b.length)],this.alpha=1,this.fading=!1}startFade(t=2e3){this.fading=!0,this.fadeStep=16/t}update(){this.fading&&this.alpha>0&&(this.alpha-=this.fadeStep,this.alpha<0&&(this.alpha=0))}draw(t){t.fillStyle=this.fillColor,t.globalAlpha=this.alpha,t.beginPath(),t.moveTo(this.x,this.y-this.radius);for(let e=0;e<2*this.sides+1;e++){let o=e%2==0?this.radius:this.radius/2,i=Math.PI*e/this.sides-Math.PI/2;t.lineTo(this.x+o*Math.cos(i),this.y+o*Math.sin(i))}t.closePath(),t.fill(),t.globalAlpha=1}}const k=(r,t,e,o,i,h)=>{const a=[],v=t,M=e;function m(){r.clearRect(0,0,v,M),r.save(),r.scale(o,o),r.translate(i,h);for(let p=0;p<a.length;p++){const c=a[p];c.update(),c.draw(r),c.alpha<=0&&a.splice(p,1)}r.restore(),requestAnimationFrame(m)}setInterval(()=>{const p=Math.random()*v,c=Math.random()*M,S=Math.random()*5e3,L=new X(p,c,15,5);a.push(L),setTimeout(()=>L.startFade(2e3),S)},100),m()};class J{constructor(t,e,o,i=!1){this.ctx=t,this.width=e,this.height=o,this.exits=[],this.platforms=[],this.currMap="Level 1",this.spawn={},this.level10Interval=null,this.hardMode=i}loadMap(t){if(this.exits=[],this.platforms=[],this.currMap=t,t==="Level 1"&&(this.exits.push(new g(this.width-100,this.height/2-53,50,50,"Level 2")),this.hardMode?this.platforms.push({x:0,y:this.height/2,width:50,height:3,color:"red",type:"floor"},{x:this.width/2.5,y:this.height/2,width:50,height:3,color:"red",type:"floor"},{x:this.width/1.2,y:this.height/2,width:50,height:3,color:"red",type:"floor"}):this.platforms.push({x:0,y:this.height/2,width:this.width,height:3,color:"red",type:"floor"}),this.spawn={x:0,y:this.height/2-53}),t==="Level 2"&&(this.exits.push(new g(this.width-100,this.height/2-50,50,50,"Level 3")),this.hardMode?this.platforms.push({x:0,y:this.height/2,width:100,height:3,color:"blue",type:"ice"},{x:3,y:this.height/2,width:3,height:this.height,color:"orange",type:"wall"},{x:100,y:this.height/2,width:3,height:this.height,color:"orange",type:"wall"},{x:200,y:this.height/3,width:100,height:3,color:"blue",type:"ice"},{x:200,y:this.height/3,width:3,height:this.height,color:"orange",type:"wall"},{x:300,y:this.height/3,width:3,height:this.height,color:"orange",type:"wall"},{x:400,y:this.height/5,width:3,height:this.height,color:"orange",type:"wall"},{x:400,y:this.height/5,width:100,height:3,color:"blue",type:"ice"},{x:500,y:this.height/5,width:3,height:this.height,color:"orange",type:"wall"},{x:600,y:this.height/7,width:3,height:this.height,color:"orange",type:"wall"},{x:600,y:this.height/7,width:100,height:3,color:"blue",type:"ice"},{x:700,y:this.height/7,width:3,height:this.height,color:"orange",type:"wall"},{x:800,y:this.height/9,width:3,height:this.height,color:"orange",type:"wall"},{x:800,y:this.height/9,width:150,height:3,color:"blue",type:"ice"},{x:950,y:this.height/9,width:3,height:this.height,color:"orange",type:"wall"}):this.platforms.push({x:0,y:this.height/2,width:this.width/4,height:3,color:"orange",type:this.hardMode?"ice":"floor"},{x:this.width/4,y:this.height/2,width:3,height:this.height-this.height/2,color:"orange",type:"wall"},{x:this.width-this.width/1.7,y:this.height/2,width:3,height:this.height-this.height/2,color:"orange",type:"wall"},{x:this.width-this.width/1.7,y:this.height/2,width:this.width/1.7,height:3,color:"orange",type:this.hardMode?"ice":"floor"}),this.spawn={x:0,y:this.height/2-53}),t==="Level 3"&&(this.hardMode?this.exits.push(new g(this.width-80,this.height-50,50,50,"Level 4")):this.exits.push(new g(this.width-100,this.height/2-50,50,50,"Level 4")),this.platforms.push({x:0,y:this.height/2,width:this.width/6,height:3,color:this.hardMode?"blue":"yellow",type:this.hardMode?"ice":"floor"},{x:this.width/2.6,y:this.height/3.3,width:this.hardMode?100:this.width/7,height:3,color:this.hardMode?"blue":"yellow",type:this.hardMode?"ice":"floor"}),this.hardMode&&this.platforms.push({x:0,y:this.height/2,width:3,height:this.height,color:"orange",type:"wall"},{x:this.width/6,y:this.height/2,width:3,height:this.height,color:"orange",type:"wall"},{x:this.width/2.6,y:this.height/3.3,width:3,height:this.height,color:"yellow",type:"wall"},{x:this.width/2.6+100,y:this.height/3.3,width:3,height:this.height,color:"orange",type:"wall"},{x:this.width-10,y:0,width:3,height:this.height,color:"orange",type:"wall"},{x:this.width-100,y:50,width:3,height:this.height,color:"orange",type:"wall"},{x:this.width-200,y:0,width:3,height:this.height-300,color:"orange",type:"wall"}),this.spawn={x:0,y:this.height/2-53}),t==="Level 4"&&(this.exits.push(new g(this.hardMode?100:0,this.height/2+10,50,50,"Level 5")),this.platforms.push({x:0,y:this.height/2,width:150,height:5,color:"green",type:"floor"},{x:150,y:this.height/2,width:5,height:this.hardMode?0:200,color:"green",type:"wall"},{x:0,y:0,width:3,height:this.height-this.height/2,color:"green",type:"wall"}),this.hardMode&&this.platforms.push({x:150,y:100,width:3,height:this.height/2-100,color:"green",type:"wall"},{x:300,y:100,width:3,height:this.height,color:"green",type:"wall"}),this.spawn={x:3,y:this.height/2-53}),t==="Level 5"&&(this.exits.push(new g(this.width-45,this.height/1.5-50,50,50,"Level 6")),this.platforms.push({x:0,y:this.height/2,width:100,height:3,color:"black",type:"floor"},{x:0,y:this.height-40,width:100,height:3,color:this.hardMode?"black":"white",type:""},{x:this.width/2,y:this.height/1.5,width:100,height:3,color:"black",type:"floor"},{x:this.width/2,y:this.height-40,width:100,height:3,color:this.hardMode?"black":"white",type:""},{x:this.width-200,y:this.height/1.5,width:200,height:3,color:"black",type:"floor"},{x:this.width-200,y:this.height-40,width:200,height:3,color:this.hardMode?"black":"white",type:""}),this.spawn={x:0,y:this.height/2-53}),t==="Level 6"&&(this.exits.push(new g(this.width/5+5,this.height/4+5,50,50,"Level 7")),this.hardMode||this.platforms.push({x:0,y:this.height/2,width:50,height:3,color:"red",type:"floor"}),this.platforms.push({x:this.width/9,y:this.height/6.5,width:5,height:this.height-800,color:this.hardMode?"red":"blue",type:"wall"},{x:this.width/5,y:this.height/4,width:5,height:this.height-400,color:this.hardMode?"red":"blue",type:"wall"},{x:this.width/5,y:this.height/4,width:this.hardMode?700:500,height:3,color:this.hardMode?"red":"blue",type:"floor"}),this.spawn={x:0,y:this.height/2-53}),t==="Level 7"&&(this.exits.push(new g(this.width-80,this.height-90,50,50,"Level 8")),this.hardMode||this.platforms.push({x:this.width/3.3,y:this.height/3,width:58,height:3,color:"purple",type:"floor"}),this.platforms.push({x:0,y:0,width:3,height:this.height,color:"purple",type:"wall"},{x:0,y:this.height/2,width:this.width/40,height:3,color:"purple",type:"floor"},{x:this.width/7,y:this.height/8,width:3,height:this.height/2,color:"purple",type:"wall"},{x:this.width/3,y:0,width:3,height:this.height/3,color:"purple",type:"wall"},{x:this.width/3,y:this.hardMode?this.height/2-100:this.height/2,width:3,height:this.hardMode?this.height:this.height/3,color:"purple",type:"wall"},{x:this.hardMode?this.width/2-100:this.width/2,y:this.height/10,width:3,height:this.height,color:"purple",type:"wall"},{x:this.width/2,y:this.height-40,width:this.width,height:5,color:"purple",type:"floor"}),this.spawn={x:3,y:this.height/2-53}),t==="Level 8"&&(this.exits.push(new g(this.width-this.width/2.5+15,this.height-55,50,50,"Level 9")),this.platforms.push({x:this.width/2.3,y:0,width:5,height:this.height,color:"pink",type:"wall"},{x:this.width/2.3,y:this.height-5,width:this.width/5,height:5,color:"pink",type:"floor"},{x:this.width-this.width/2.5,y:this.height/8,width:5,height:this.height,color:"pink",type:"wall"}),this.spawn={x:this.width/2,y:this.height-55}),t==="Level 9"&&(this.exits.push(new g(this.width-50,this.height-90,50,50,"Level 10")),this.hardMode||this.platforms.push({x:this.width/2,y:this.height/2+200,width:50,height:5,color:"white",type:"floor"}),this.platforms.push({x:0,y:55,width:55,height:5,color:"white",type:"floor"},{x:50,y:0,width:5,height:55,color:"white",type:"wall"},{x:this.width/1.7,y:this.height-40,width:this.width,height:5,color:"white",type:"floor"},{x:this.width/1.7,y:0,width:5,height:this.height/1.5-10,color:"white",type:"wall"},{x:this.width/1.7,y:this.height/1.5+60,width:5,height:this.height/4-30,color:"white",type:"wall"}),this.spawn={x:0,y:0}),t==="Level 10"?(this.level10Interval&&clearInterval(this.level10Interval),this.level10Interval=setInterval(()=>{const e=Math.random()*this.width,o=Math.random()*this.height,i=new g(e,o,50,50,"Level 11");this.exits.push(i),setTimeout(()=>{const h=this.exits.indexOf(i);h>-1&&this.exits.splice(h,1)},1e3)},1e3),this.platforms.push({x:0,y:0,width:5,height:this.height,color:"white",type:"wall"},{x:0,y:0,width:this.width,height:5,color:"white",type:"wall"},{x:this.width-5,y:0,width:5,height:this.height,color:"white",type:"wall"},{x:0,y:this.height-5,width:this.width,height:5,color:"white",type:"floor"}),this.spawn={x:this.width/2,y:this.height-55}):this.level10Interval&&(clearInterval(this.level10Interval),this.level10Interval=null),t==="Level 11"){const e=document.getElementById("stars"),o=e.getContext("2d");e.width=window.innerWidth,e.height=window.innerHeight;const i=Math.min(e.width/1920,e.height/1080),h=(e.width/i-1920)/2,a=(e.height/i-1080)/2;k(o,1920,1080,i,h,a),this.exits.push(new g(this.width/2-50,this.height-200,50,50,"Level 1")),this.platforms.push({x:this.width/2-50,y:this.height/2,width:50,height:3,color:"white",type:"floor"}),this.spawn={x:this.width/2-50,y:this.height/2-55}}}drawMap(){for(const t of this.platforms)this.ctx.fillStyle=t.color,this.ctx.fillRect(t.x,t.y,t.width,t.height);for(const t of this.exits)t.draw(this.ctx)}}const w=document.getElementById("canvas"),s=w.getContext("2d"),R=document.querySelector("body");R.style.backgroundColor="black";let f,A,E;const n=1920,y=1080;function T(){w.width=window.innerWidth,w.height=window.innerHeight,f=Math.min(w.width/n,w.height/y),A=(w.width-n*f)/2,E=(w.height-y*f)/2}T();window.addEventListener("resize",T);const d=new J(s,n,y);d.loadMap("Level 1");const l=new Y(d.spawn.x,d.spawn.y,50,50,15),x={};window.addEventListener("keydown",r=>{x[r.key]=!0});window.addEventListener("keyup",r=>{x[r.key]=!1});let I=0;function W(r){const t=(r-I)/1e3;I=r,s.clearRect(0,0,w.width,w.height),s.save(),s.scale(f,f),s.translate(A,E),l.isDead?l.respawn(d):(x.a&&l.move("a"),x.d&&l.move("d"),x[" "]&&l.move(" "),l.update(t,d.platforms,w)),l.currMap==="Level 1"&&!l.hardMode&&(s.save(),s.fillStyle="white",s.textAlign="center",s.font="200px Arial",s.fillText("Square Game",n/2,y/2),s.restore()),l.currMap==="Level 2"&&!l.hardMode&&(s.save(),s.fillStyle="white",s.textAlign="center",s.font="200px Arial",s.fillText("By N. Lugo",n/2,y/2),s.restore()),l.draw(s),d.drawMap();for(const e of d.exits)l.collides(e)&&(l.currMap==="Level 11"&&!l.hardMode?(l.hardMode=!0,d.hardMode=!0):l.currMap==="Level 11"&&l.hardMode&&(l.hardMode=!1,d.hardMode=!1),d.loadMap(e.nextLevel),l.currMap=e.nextLevel,l.velocityY=0,l.velX=0,l.isJumping=!1,d.spawn&&(l.x=d.spawn.x,l.y=d.spawn.y));l.currMap==="Level 11"&&(s.save(),s.fillStyle="white",s.textAlign="center",!l.hardMode||!d.hardMode?(s.font="100px Arial",s.fillText("The End!",n/2,y/3),s.font="50px Arial",s.fillText("Hard Mode?",n/2-30,y-250)):(s.font="100px Arial",s.fillText("The Official End!",n/2,y/3),s.font="50px Arial",s.fillText("Restart?",n/2-30,y-250)),s.restore()),s.restore(),requestAnimationFrame(W)}requestAnimationFrame(W);
